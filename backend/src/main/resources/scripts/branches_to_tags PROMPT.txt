Please ultrathink hard on this:
I've created AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_tag_PLANNING.txt and AKSEP\Schoolsystem2\backend\src\main\resources\csv\ct_topic_tags_PLANNING.txt, imported AKSEP\Schoolsystem2\backend\src\main\resources\csv\Branches.csv and updated AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_topic.csv from Google Sheets; Our mission is now the following: Based on all Topics you can find in AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_topic.csv, we now want to create a set of Tags that's distributed between all major disciplines of science as fairly as possible when it comes to actually assigning Tags to scientific fields represented by an according topic. But how could we achieve that? For this, I've come up with the following plan: The goal of Phase 1 is to setup a full set of Tags (=> AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_tag_PLANNING.txt, but with empty Synonyms) and a full Tags-Assignment (=> AKSEP\Schoolsystem2\backend\src\main\resources\csv\ct_topic_tags_PLANNING.txt); Phase 2 then adds Synonyms to AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_tag.csv. Now, starting with Phase 1, we need to setup a Script AKSEP\Schoolsystem2\backend\src\main\resources\scripts\branches_to_tags.ps1 that works as follows:
0. Go through every single entry in AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_topic.csv from top to bottom: For every entry in t_topic.csv:
  1. Save Values into Variables: $topicID = t_topic.topicID (t_topic Column A), $name = t_topic.name (t_topic Column C), $layer = t_topic.layer (t_topic Column E).
  2. Extract from AKSEP\Schoolsystem2\backend\src\main\resources\csv\Branches.csv the row with Branches.Branch == t_topics.name.
  3. Take the values of the 4 "attached to" columns, remove all entries that don't start with a letter [a-Z], then save the remaining in an Array => $attachedTo (For `layer==1` subjects, this Array will be empty).
  4. initialize an empty list of Strings $attachedTagIDs (important: This list is treated as a set when it comes to adding new entries).
  5. For every Object in $attachedTo:
5a. Get from AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_topic.csv the row where Column C "name" == the current $attachedTo entry and then save that row's topicID in $attachedTopicID.
5b. Get from AKSEP\Schoolsystem2\backend\src\main\resources\csv\ct_topic_tags_PLANNING.txt all rows that begin with $attachedTopicID+"," and add their Column B "tagID" to $attachedTagIDs (remember that this is a set; `[1,2,4].add(2)` results in `[1,2,4]` again; We only want unique tagIDs).
  6. if ($attachedTagIDs.size < $layer): Add a new line to AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_tag_PLANNING.txt: `[tagID],"uniformed($name)",""` with `function uniformed(String)` serving the purpose to remove any tailing " science", " studies", " theory" or " (.*)" from the given String. 7. For every item in $attachedTagIDs (let $i = 0): Add a new line to AKSEP\Schoolsystem2\backend\src\main\resources\csv\ct_topic_tags_PLANNING.txt: `$topicID,$attachedTagID[i],getWeight(size=$attachedTagID.size,index=i)` with `function getWeight(size,index): minuend=6, f_size=1, f_index=9, size_shift=-30, index_shift=7 (these variables can be customized if needed); return 0 if index >= size; return 5 if size==1 else MAX(minuend-floor((sqrt(f_size*(size+size_shift)+f_index*(index+index_shift)))/2,0),1)`


For context, here you find the start of AKSEP\Schoolsystem2\backend\src\main\resources\csv\Branches.csv:
```csv
Branch,Description,attached to,& attached to,& attached to,& attached to,Layer 1,Layer 2,Layer 3,Layer 4,Layer 5,Layer 6,Layer 7,Layer 8,Layer,Type,Status
Art,"Creative human expression across visual, auditory and performance media; the umbrella discipline for the fine arts",–,–,–,–,TRUE,,,,,,,,1,S,1
Biology,Science that studies life,–,–,–,–,TRUE,,,,,,,,1,S,1
Chemistry,Scientific field of study – study of properties and behaviours of substances.,–,–,–,–,TRUE,,,,,,,,1,S,1
Computer science,Study of computation – study of processes that interact with data.,–,–,–,–,TRUE,,,,,,,,1,S,1
Cultural studies,"Interdisciplinary analysis of culture, power and identity in everyday life and media",–,–,–,–,TRUE,,,,,,,,1,S,1
Ethics,"Philosophical study of moral values, principles and decision-making",–,–,–,–,TRUE,,,,,,,,1,S,1
Geography,Study of lands and inhabitants of Earth – study of surface of the earth and its inhabitants,–,–,–,–,TRUE,,,,,,,,1,S,1
History,Systematic study and interpretation of past events and human activities,–,–,–,–,TRUE,,,,,,,,1,S,1
Law,System of rules created and enforced through social or governmental institutions to regulate behaviour,–,–,–,–,TRUE,,,,,,,,1,S,1
Linguistics,Scientific study of language,–,–,–,–,TRUE,,,,,,,,1,S,1
Literary Studies,Study and analysis of written and oral texts as artistic and cultural artefacts, = Literature,–,–,–,TRUE,,,,,,,,1,S,1
Literature,Study and analysis of written and oral texts as artistic and cultural artefacts,–,–,–,–,TRUE,,,,,,,,1,S,1
...
```

And here the start of AKSEP\Schoolsystem2\backend\src\main\resources\csv\t_topic.csv:
```csv
topicID,lang,name,typeID,layer,description,version,url
ART0,en,Art,0,1,"Creative human expression across visual, auditory and performance media; the umbrella discipline for the fine arts",1,https://en.wikipedia.org/wiki/Art_history
BOL0,en,Biology,0,1,Science that studies life,1,https://en.wikipedia.org/wiki/Biochemistry
CHE0,en,Chemistry,0,1,Scientific field of study – study of properties and behaviours of substances.,1,https://en.wikipedia.org/wiki/Chaology
COS0,en,Computer science,0,1,Study of computation – study of processes that interact with data.,1,https://en.wikipedia.org/wiki/Codicology
CUS0,en,Cultural studies,0,1,"Interdisciplinary analysis of culture, power and identity in everyday life and media",1,https://en.wikipedia.org/wiki/Cryptography
ETH0,en,Ethics,0,1,"Philosophical study of moral values, principles and decision-making",1,https://en.wikipedia.org/wiki/Epidemiology
GOG0,en,Geography,0,1,Study of lands and inhabitants of Earth – study of surface of the earth and its inhabitants,1,https://en.wikipedia.org/wiki/Gnotobiology
HSR0,en,History,0,1,Systematic study and interpretation of past events and human activities,1,https://en.wikipedia.org/wiki/Hydrology
LAW0,en,Law,0,1,System of rules created and enforced through social or governmental institutions to regulate behaviour,1,https://en.wikipedia.org/wiki/Kalology
LIN0,en,Linguistics,0,1,Scientific study of language,1,https://en.wikipedia.org/wiki/Limacology
LIT0,en,Literature,0,1,Study and analysis of written and oral texts as artistic and cultural artefacts,1,https://en.wikipedia.org/wiki/Limacology
LOG0,en,Logics,0,1,Study of correct reasoning,1,https://en.wikipedia.org/wiki/Limacology
```
